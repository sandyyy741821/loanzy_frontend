<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Cloudflare Turnstile CAPTCHA Demo</title>
  <script src="https://challenges.cloudflare.com/turnstile/v0/api.js" async defer></script>
</head>
<body>
  <h2>Turnstile CAPTCHA Test</h2>

  <div class="cf-turnstile" data-sitekey="0x4AAAAAABet_YrZDjLmY4xM" data-callback="onCaptchaSuccess"></div>

  <br />

  <button id="submitBtn">Submit</button>

  <p id="result"></p>

  <script>
    let captchaToken = '';

    function onCaptchaSuccess(token) {
      captchaToken = token;
      document.getElementById('result').textContent = 'Captcha completed. You can submit.';
    }

    document.getElementById('submitBtn').addEventListener('click', async () => {
      if (!captchaToken) {
        document.getElementById('result').textContent = 'Please complete the captcha first!';
        return;
      }

      const response = await fetch('https://captcha_verification.santhosh-rv173.workers.dev', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ token: captchaToken })
      });

      const data = await response.json();

      if (data.success) {
        document.getElementById('result').textContent = 'Captcha verification passed!';
      } else {
        document.getElementById('result').textContent = 'Captcha verification failed!';
      }

      captchaToken = '';
      turnstile.reset(); 
    });
  </script>
</body>
</html>
